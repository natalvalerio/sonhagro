<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório Diário de Atendimento</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
    <script>
        const nichos = [" ", "LOJA", "FARMÁCIA", "SUPERMERCADO"];
        const situacoes = [" ", "ATENDIMENTO", "PROSPECÇÃO"];
        const canais = [" ", "Chat", "VOZ"];
        const status = [" ", "CHAMADA NÃO ATENDIDA", "CAIXA POSTAL", "CONTATO INCORRETO", "ATENDIMENTO EFETUADO", "PEDIDO CONCLUÍDO", "CATÁLOGO ENVIADO", "OUTROS"];

        function createSelect(options, selectedValue = "") {
            let select = document.createElement("select");
            options.forEach(option => {
                let opt = document.createElement("option");
                opt.value = option;
                opt.textContent = option;
                if (option === selectedValue) {
                    opt.selected = true;
                }
                select.appendChild(opt);
            });
            return select;
        }
		//NOME	NICHO	SITUACAO	DATA	HORA	CANAL	OBSERVACOES	STATUS
        function populateRow(row, data = {}) {
            row.appendChild(document.createElement("td")).appendChild(document.createElement("input")).value = data.nome || "";
            row.appendChild(document.createElement("td")).appendChild(createSelect(nichos, data.nicho));
            row.appendChild(document.createElement("td")).appendChild(createSelect(situacoes, data.situacao));
            row.appendChild(document.createElement("td")).appendChild(document.createElement("input")).value = data.data || "";
            row.lastChild.firstChild.type = "date";
            row.appendChild(document.createElement("td")).appendChild(document.createElement("input")).value = data.hora || "";
            row.lastChild.firstChild.type = "time";
            row.appendChild(document.createElement("td")).appendChild(createSelect(canais, data.canal));
            row.appendChild(document.createElement("td")).appendChild(document.createElement("input")).value = data.observacoes || "";
            row.appendChild(document.createElement("td")).appendChild(createSelect(status, data.status));
        }

        function addRow(data = {}) {
            let tbody = document.querySelector("tbody");
            let row = document.createElement("tr");
            populateRow(row, data);
            tbody.appendChild(row);
        }

        async function fetchData() {
            try {
                let response = await fetch("https://natalvalerio.pythonanywhere.com/api/select/qualit");
                let data = await response.json();
                let tbody = document.querySelector("tbody");
                tbody.innerHTML = ""; 
                data.forEach(item => addRow(item));
            } catch (error) {
                console.error("Erro ao buscar dados: ", error);
            }
        }
        
        window.onload = fetchData;
    </script>
</head>
<body>
    <img src="imagem.png" width="200" alt="Logo da Empresa">
    <h2>Relatório Diário de Atendimento</h2>
    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Nicho</th>
                <th>Situação</th>
                <th>Data</th>
                <th>Hora</th>
                <th>Canal</th>
                <th>Observações</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <button onclick="addRow()">Adicionar Linha</button>
</body>
</html>
